<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Mertics | TA Servers (demo)</title>
    <meta property="og:title" content="Metrics | TA Servers">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta property="og:description" content="">
    <meta name="author" content="Giga">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="TA Servers">
    <meta property="og:image" content="">
    <meta property="og:url" content="https://servers.wilderzone.live/metrics/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ffffff">
    <link rel="shortcut icon" href="../icons/dns_black_24dp.svg">
    <link rel="stylesheet" href="../css/style.css">
  </head>
  
  <body>
    <main>
      <div id="navbar">
        <a href="../" class="logo"><img src="../icons/dns_black_24dp.svg" draggable="false" alt=""><div class="title">Servers</div></a>
        
        <div class="navlinks">
          <a href="../"><p>Server List</p><div></div></a>
          <a href="../schedules/"><p>Schedules</p><div></div></a>
          <a href="" class="activeNav"><p>Metrics</p><div></div></a>
          <a href="../about/"><p>About</p><div></div></a>
          <a href="../login/" style="float: right;" id="loginButton"><p>Login<img src="../icons/login_black_24dp.svg" draggable="false" alt=""></p></a>
        </div>
      </div>
      
      <img class="refresh" src="../icons/refresh_black_24dp.svg" draggable="false" title="Refresh" alt="Refresh" onclick="clearCanvas();getHistogramData()">
      <div class="alert hidden" style="width:calc(100% - 70px);"><img src="../icons/cancel_24dp.svg" draggable="false" alt=""><p></p></div>
      
      <div id="pageContent">
        <div id="plotTitle" style="margin-bottom:4px;">Loading...</div>
        <div id="canvas"></div>
      </div>
    </main>
    
    <footer>
      <p>Designed&nbsp;by&nbsp;Gigabyte5671&nbsp;&copy;2021&nbsp;|&nbsp;Gigabyte#3310&nbsp;|&nbsp;Thanks&nbsp;for&nbsp;your&nbsp;support<img src="../icons/heart-24px.svg" draggable="false" alt=""></p>
    </footer>
  </body>
  
  <script src="../lib/site_message.js"></script>
  <script src="../lib/jquery.min.js"></script>
  <script src="../lib/cookieManager.min.js"></script>
  <script>if(checkCookie("arl") === true){$("#loginButton").attr("href", "../admin/");$("#loginButton").children().first().html('Admin<img src="../icons/account_circle_24dp.svg" draggable="false" alt="">');}</script>
  <script src="../lib/statusURL.js"></script>
  <script src="../lib/p5.min.js"></script>
  <script src="../lib/drawHistogramPlot.js"></script>
  <script>
    var hdata;
    var currentDate;
    var months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
    var monthsLong = ["January","February","March","April","May","June","July","August","September","October","November","December"];
    
    function getCurrentDate(){
      currentDate = new Date();
      currentDate = currentDate.toUTCString().substr(5,11).split(" ");
      currentDate = currentDate[0] + "/" + (months.indexOf(currentDate[1]) + 1);
    }
    getCurrentDate();
    
    function getHistogramData(){
      var item = '<tr>'
               +   '<th>Server</th>'
               +   '<th>Currently</th>'
               +   '<th>Times (GMT)</th>'
               + '</tr>';
      $("#scheduleTable").children().first().append(item);
      
      $.ajax({
        dataType:"json",
        url:"../histogram.json",
        success:function(data1){
          hdata = data1;
          cnv_enable = 1;
          $("#plotTitle").html("Player Count History (" + monthsLong[parseInt(Object.keys(hdata)[0].substr(5,2)) - 1] + " " + Object.keys(hdata)[0].substr(0,4) + " to " +  monthsLong[parseInt(Object.keys(hdata)[Object.keys(hdata).length - 1].substr(5,2)) - 1] + " " + Object.keys(hdata)[Object.keys(hdata).length - 1].substr(0,4) + ")")
        },
        error:function(xhr, status, err){
          console.log("Error " + xhr.status);
          cnv_enable = 0;
          var item = '<h2 style="margin-top:100px;text-align:center;">Schedule data couldn&#39;t be retrieved. Please try again later.</h2>';
          $("#pageContent").append(item);
          var alertMsg = "Error " + xhr.status;
          $(".alert").children(":nth-child(2)").html(alertMsg);
          $(".alert").addClass("alert_error");
          $(".alert").removeClass("hidden");
        }
      });
    }
    
    getHistogramData();
  </script>
</html>